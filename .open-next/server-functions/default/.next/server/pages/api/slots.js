"use strict";(()=>{var e={};e.id=650,e.ids=[650],e.modules={5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9642:e=>{e.exports=import("luxon")},6762:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},9631:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>u,default:()=>l,routeModule:()=>c});var o=r(9947),n=r(2706),s=r(6762),i=r(6545),d=e([i]);i=(d.then?(await d)():d)[0];let l=(0,s.M)(i,"default"),u=(0,s.M)(i,"config"),c=new o.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/slots",pathname:"/api/slots",bundlePath:"",filename:""},userland:i});a()}catch(e){a(e)}})},6545:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>s});var o=r(9642),n=e([o]);o=(n.then?(await n)():n)[0];let i="64693698ebab23975e6f5d11f9f3b170a6d11b9a19ebb459e1486314ee930ebf@group.calendar.google.com",d="AIzaSyDqIFZZGAK6xL9ST0gTkPUZL-jmd5lElbk";async function s(e,t){let{action:r,date:a,mode:n="normal"}=e.query;if("getBusySlots"!==r)return t.status(400).json({error:"Acci\xf3n no soportada. Usa action=getBusySlots."});if(!i||!d)return t.status(500).json({error:"Faltan configuraciones de Google Calendar."});if(!a)return t.status(400).json({error:"El par\xe1metro date es obligatorio (YYYY-MM-DD)."});try{let e=function({date:e,timezone:t}){let r=o.DateTime.fromISO((e||"")+"T00:00",{zone:t});if(!r.isValid)throw Error("Fecha inv\xe1lida");let a=r.endOf("day"),n=new URLSearchParams({key:d,timeMin:r.toUTC().toISO(),timeMax:a.toUTC().toISO(),singleEvents:"true",orderBy:"startTime",maxResults:"2500"}),s=encodeURIComponent(i||"");return"https://www.googleapis.com/calendar/v3/calendars/"+s+"/events?"+n.toString()}({date:a,timezone:"America/Santiago"}),r=await fetch(e),s=await r.json().catch(()=>null);if(!r.ok||!s){let a=s?.error?.message||"Error obteniendo eventos del calendario.";return t.status(r.status).json({error:a,diagnosticInfo:{url:e}})}let l=(s.items||[]).filter(e=>!e.start?.date&&!e.end?.date).map(e=>({id:e.id,start:e.start?.dateTime||e.start?.date,end:e.end?.dateTime||e.end?.date,summary:e.summary||""}));return t.status(200).json({busy:l,mode:n,source:"google-calendar-api"})}catch(e){return console.error("Error en /api/slots (Google Calendar):",e),t.status(500).json({error:e.message||"Error interno obteniendo los horarios."})}}a()}catch(e){a(e)}})},2706:(e,t)=>{var r;Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE"}(r||(r={}))},9947:(e,t,r)=>{e.exports=r(5600)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=9631);module.exports=r})();