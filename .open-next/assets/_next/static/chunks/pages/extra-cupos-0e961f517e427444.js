(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{8778:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/extra-cupos",function(){return n(6473)}])},429:function(e,s,n){"use strict";n.d(s,{Z:function(){return i}});var t=n(5893),r=n(9257),a=n(221);function i(e){let{service:s,date:n,time:i,client:l,isExtra:o}=e;return s&&n&&i&&l?(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-600 mb-2",children:"\xa1Cita Confirmada!"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Recibir\xe1s un correo con los detalles de tu reserva."}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 text-left",children:[(0,t.jsxs)("h3",{className:"font-semibold mb-3 text-lg text-gray-800",children:["Resumen de tu cita ",o&&"(EXTRA CUPO)",":"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium text-gray-600",children:"Servicio:"}),(0,t.jsx)("span",{className:"text-gray-800 font-semibold text-right",children:s.name})]}),(0,t.jsxs)("p",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium text-gray-600",children:"Fecha:"}),(0,t.jsx)("span",{className:"text-gray-800 font-semibold",children:(0,r.WU)(n,"d MMMM yyyy",{locale:a.es})})]}),(0,t.jsxs)("p",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium text-gray-600",children:"Hora:"}),(0,t.jsx)("span",{className:"text-gray-800 font-semibold",children:i})]})]})]}),(0,t.jsx)("p",{className:"mt-4 text-sm text-gray-500",children:"Redirigiendo al inicio en unos segundos..."})]}):null}},6473:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return f}});var t=n(5893),r=n(7294),a=n(9008),i=n.n(a),l=n(1664),o=n.n(l),c=n(3957),d=n(9257),m=n(221),x=n(8583),u=n(429);let h=[{id:1,name:"Retoque (Mantenimiento)",duration:120},{id:2,name:"Reconstrucci\xf3n U\xf1as Mordidas (Onicofagia)",duration:180},{id:3,name:"U\xf1as Acr\xedlicas",duration:180},{id:4,name:"U\xf1as Polygel",duration:180},{id:5,name:"U\xf1as Softgel",duration:180},{id:6,name:"Kapping o Ba\xf1o Polygel o Acr\xedlico sobre u\xf1a natural",duration:150},{id:7,name:"Reforzamiento Nivelaci\xf3n Rubber",duration:150},{id:8,name:"Esmaltado Permanente",duration:90}],p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:28,s=[],n=new Date;for(let t=0;t<e;t++){let e=(0,c.E)(n,t);s.push(e)}return s};function f(){var e,s;let[n,a]=(0,r.useState)(""),[l,c]=(0,r.useState)(null),[f,g]=(0,r.useState)(""),[b,j]=(0,r.useState)({name:"",email:"",phone:""}),[v,y]=(0,r.useState)(1),[N,w]=(0,r.useState)([]),[k,C]=(0,r.useState)(!1),[S,E]=(0,r.useState)(null),[M,U]=(0,r.useState)(null),[T,D]=(0,r.useState)(!1),[R,W]=(0,r.useState)({width:void 0,height:void 0}),P=p(35);async function _(e,s){try{C(!0),E(null);let n=(0,d.WU)(e,"yyyy-MM-dd"),t=h.find(e=>String(e.id)===String(s));if(!t)throw Error("Servicio no encontrado");let r=await fetch("/api/slots?action=getBusySlots&date=".concat(n,"&mode=extra")),a=await r.json().catch(()=>null);if(!r.ok||!a){let e=(null==a?void 0:a.error)||"Error cargando horarios";throw Error(e)}let i=(Array.isArray(a.busy)?a.busy:[]).map(e=>({start:new Date(e.start),end:new Date(e.end)})),l=t.duration,o=new Date("".concat(n,"T18:00:00")),c=new Date("".concat(n,"T20:00:00")),m=[],x=new Date(o);for(;x<c;)m.push(new Date(x)),x.setMinutes(x.getMinutes()+30);let u=m.filter(e=>{let s=new Date(e.getTime()+6e4*l),n=i.some(n=>e<n.end&&s>n.start),t=new Date>e;return!n&&!t}).map(e=>(0,d.WU)(e,"HH:mm"));w(u)}catch(e){E(String((null==e?void 0:e.message)||e)),w([])}finally{C(!1)}}function H(e,s){j(n=>({...n,[e]:s}))}(0,r.useEffect)(()=>{l&&n&&_(l,n)},[l,n]),(0,r.useEffect)(()=>{function e(){W({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);let O=async e=>{let s=e.target.value;if(s&&s.includes("@"))try{D(!0);let e=await fetch("/api/client?email=".concat(encodeURIComponent(s))),n=await e.json();e.ok&&n.client&&j(e=>({...e,name:n.client.name||e.name,phone:n.client.phone||e.phone}))}catch(e){console.error("Error al autocompletar datos del cliente:",e)}finally{D(!1)}};async function A(e){e.preventDefault();try{U({loading:!0});let e={serviceId:n,date:(0,d.WU)(l,"yyyy-MM-dd"),start:f,extraCup:!0,client:b},s=await fetch("/api/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();if(!s.ok||(null==t?void 0:t.error))throw Error((null==t?void 0:t.error)||"Error al confirmar la cita");U({success:!0,message:"\xa1Cita EXTRA CUPO confirmada!"}),setTimeout(()=>{a(""),c(null),g(""),j({name:"",email:"",phone:""}),y(1),U(null)},2500)}catch(e){U({error:!0,message:String(e.message||e)})}}let V=e=>e?(0,d.WU)(e,"d MMMM yyyy",{locale:m.es}):"";return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsxs)(i(),{children:[(0,t.jsx)("title",{children:"Turnos Extra Cupos - Vanessa Nails Studio"}),(0,t.jsx)("meta",{name:"description",content:"Reserva extra cupos (18:00 a 20:00) con recargo"})]}),(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-pink-600",children:"Turnos Extra Cupos"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Horarios extendidos (18:00 a 20:00) con recargo"})]}),(0,t.jsxs)(o(),{href:"/",className:"inline-flex items-center text-pink-600 hover:text-pink-800",children:[(0,t.jsx)("span",{className:"text-lg",children:"←"}),(0,t.jsx)("span",{className:"ml-2",children:"Volver"})]})]}),(0,t.jsxs)("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 text-amber-900 rounded-lg",children:["⚠ Al seleccionar estos turnos, existe un ",(0,t.jsx)("b",{children:"recargo adicional de $5.000"}),", indistintamente del servicio."]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("div",{className:"flex justify-center items-center mb-4",children:[1,2,3,4].map(e=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(v>=e?"bg-pink-600 text-white":"bg-gray-300 text-gray-600"),children:e}),e<4&&(0,t.jsx)("div",{className:"w-16 h-1 ".concat(v>e?"bg-pink-600":"bg-gray-300")})]},e))}),(0,t.jsxs)("div",{className:"flex justify-between max-w-xs mx-auto text-sm text-gray-600",children:[(0,t.jsx)("span",{className:"flex-1 text-center",children:"Servicio"}),(0,t.jsx)("span",{className:"flex-1 text-center",children:"Fecha"}),(0,t.jsx)("span",{className:"flex-1 text-center",children:"Hora"}),(0,t.jsx)("span",{className:"flex-1 text-center",children:"Datos"})]})]}),1===v&&(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mb-8 text-center text-gray-800",children:"Selecciona tu servicio"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...h].sort((e,s)=>e.duration-s.duration).map(e=>(0,t.jsxs)("div",{onClick:()=>{a(e.id),c(null),g(""),y(2)},className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer border border-gray-100 overflow-hidden transform hover:-translate-y-1 hover:scale-105 h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"p-6 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center group-hover:bg-pink-200 transition-colors flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{className:"bg-pink-100 text-pink-800 text-xs font-bold px-2 py-1 rounded-full",children:[e.duration," min"]})]}),(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4 group-hover:text-pink-600 transition-colors flex-1",children:e.name}),(0,t.jsxs)("button",{className:"mt-auto w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 shadow-md hover:shadow-lg flex items-center justify-center",children:["Seleccionar",(0,t.jsx)("svg",{className:"inline-block w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-500/5 to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]},e.id))})]}),2===v&&(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:["Selecciona una fecha para ",null===(e=h.find(e=>e.id===n))||void 0===e?void 0:e.name]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:P.map((e,s)=>{let n=(0,d.WU)(e,"yyyy-MM-dd"),r=new Date;r.setHours(0,0,0,0);let a=n===(0,d.WU)(r,"yyyy-MM-dd"),i=l?(0,d.WU)(l,"yyyy-MM-dd"):"";return(0,t.jsxs)("button",{onClick:()=>{c(e),g(""),y(3)},className:"p-3 rounded-lg border transition-all focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 ".concat(i===n?"bg-pink-600 text-white border-pink-600 transform scale-105":"bg-white text-gray-800 border-gray-200 hover:border-pink-300 hover:shadow-sm"),children:[(0,t.jsx)("div",{className:"font-medium",children:a?"Hoy":(0,d.WU)(e,"EEE",{locale:m.es})}),(0,t.jsx)("div",{className:"text-lg font-bold",children:(0,d.WU)(e,"d")}),(0,t.jsx)("div",{className:"text-xs",children:(0,d.WU)(e,"MMM",{locale:m.es})})]},s)})}),(0,t.jsx)("div",{className:"mt-6 text-center",children:(0,t.jsx)(o(),{href:"/",className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a inicio"})})]}),3===v&&(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:["Selecciona un horario para el ",V(l)]}),S&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Error:"})," ",String(S)]}),(0,t.jsx)("p",{className:"text-sm mt-2",children:"Por favor, verifica tu conexi\xf3n e int\xe9ntalo nuevamente."})]}),l&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Horarios disponibles - ",V(l)]}),k?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Cargando horarios disponibles..."}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"})})]}):N&&N.length>0?(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:N.map(e=>(0,t.jsx)("button",{onClick:()=>{g(e),y(4)},className:"p-3 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 ".concat(f===e?"bg-pink-600 text-white transform scale-105":"bg-white border border-gray-200 hover:border-pink-300 hover:shadow-sm"),children:e},e))}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"No hay horarios disponibles para este d\xeda. Elige otro d\xeda."}),(0,t.jsx)("button",{onClick:()=>y(2),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"← Volver a fechas"})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,t.jsx)("button",{onClick:()=>y(2),className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a fechas"}),f&&(0,t.jsx)("button",{onClick:()=>y(4),className:"px-6 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50",children:"Continuar"})]})]}),4===v&&((null==M?void 0:M.success)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{width:R.width,height:R.height,recycle:!1,numberOfPieces:500,tweenDuration:1e4}),(0,t.jsx)(u.Z,{service:h.find(e=>e.id===n),date:l,time:f,client:b,isExtra:!0})]}):(0,t.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Tus datos"}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6 border border-gray-200",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3 text-lg",children:"Resumen de tu cita (EXTRA CUPO):"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:"Servicio:"}),(0,t.jsx)("span",{children:null===(s=h.find(e=>e.id===n))||void 0===s?void 0:s.name})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:"Fecha:"}),(0,t.jsx)("span",{children:V(l)})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:"Hora:"}),(0,t.jsx)("span",{children:f})]})]})]}),(0,t.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),(0,t.jsx)("input",{type:"text",required:!0,value:b.name,onChange:e=>H("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"Tu nombre completo"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"email",required:!0,value:b.email,onChange:e=>H("email",e.target.value),onBlur:O,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"tu@email.com"}),T&&(0,t.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-pink-600"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono *"}),(0,t.jsx)("input",{type:"tel",required:!0,value:b.phone,onChange:e=>H("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"+56 9 1234 5678"})]}),M&&(0,t.jsxs)("div",{className:"mt-4 p-4 rounded-lg ".concat(M.loading?"bg-blue-100 text-blue-800":M.success?"bg-green-100 text-green-800":M.error?"bg-red-100 text-red-800":""),children:[M.loading&&(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),(0,t.jsx)("span",{children:"Confirmando cita..."})]}),M.success&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:M.message}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Revisa tu correo para el detalle e invitaci\xf3n de Calendar."})]}),M.error&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold",children:["Error: ",M.message]}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Por favor, int\xe9ntalo nuevamente."})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row justify-between gap-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>y(3),className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a horarios"}),(0,t.jsx)("button",{type:"submit",disabled:null==M?void 0:M.loading,className:"px-6 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 disabled:opacity-50 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50",children:(null==M?void 0:M.loading)?"Confirmando...":"Confirmar Cita"})]})]})]}))]}),(0,t.jsx)("footer",{className:"py-6 text-center text-gray-500 text-sm",children:(0,t.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Vanessa Nails Studio. Todos los derechos reservados."]})})]})}}},function(e){e.O(0,[801,888,774,179],function(){return e(e.s=8778)}),_N_E=e.O()}]);