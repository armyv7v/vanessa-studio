(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{8778:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/extra-cupos",function(){return t(6473)}])},429:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var n=t(5893),r=t(9257),a=t(221);function i(e){let{service:s,date:t,time:i,client:l,isExtra:o}=e;return s&&t&&i&&l?(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-green-600 mb-2",children:"\xa1Cita Confirmada!"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Recibir\xe1s un correo con los detalles de tu reserva."}),(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 text-left",children:[(0,n.jsxs)("h3",{className:"font-semibold mb-3 text-lg text-gray-800",children:["Resumen de tu cita ",o&&"(EXTRA CUPO)",":"]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"font-medium text-gray-600",children:"Servicio:"}),(0,n.jsx)("span",{className:"text-gray-800 font-semibold text-right",children:s.name})]}),(0,n.jsxs)("p",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"font-medium text-gray-600",children:"Fecha:"}),(0,n.jsx)("span",{className:"text-gray-800 font-semibold",children:(0,r.WU)(t,"d MMMM yyyy",{locale:a.es})})]}),(0,n.jsxs)("p",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"font-medium text-gray-600",children:"Hora:"}),(0,n.jsx)("span",{className:"text-gray-800 font-semibold",children:i})]})]})]}),(0,n.jsx)("p",{className:"mt-4 text-sm text-gray-500",children:"Redirigiendo al inicio en unos segundos..."})]}):null}},5411:function(e,s,t){"use strict";t.d(s,{u:function(){return n}});let n=[{id:1,name:"Retoque (Mantenimiento)",duration:120},{id:2,name:"Reconstrucci\xf3n U\xf1as Mordidas (Onicofag\xeda)",duration:180},{id:3,name:"U\xf1as Acr\xedlicas",duration:180},{id:4,name:"U\xf1as Polygel",duration:180},{id:5,name:"U\xf1as Softgel",duration:180},{id:6,name:"Kapping o Ba\xf1o Polygel o Acr\xedlico sobre u\xf1a natural",duration:150},{id:7,name:"Reforzamiento Nivelaci\xf3n Rubber",duration:150},{id:8,name:"Esmaltado Permanente",duration:90}]},3794:function(e,s,t){"use strict";function n(e){let{date:s,openHour:t,closeHour:n,stepMinutes:r,durationMinutes:a,busy:i=[],tz:l="America/Santiago",allowOverflowEnd:o=!1}=e,[c,d,m]=s.split("-").map(Number),u=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Date(c,d-1,m,e,s,0,0)};u(0,0);let x=u(t,0),h=u(n,0),p=i.map(e=>({start:new Date(e.start),end:new Date(e.end)})),f=[],g=new Date(x),b=e=>{let s=new Date(e.getTime()+6e4*a);return o?e<h:s<=h};for(;b(g);){let e=new Date(g),s=new Date(e.getTime()+6e4*a),t=p.some(t=>e<t.end&&s>t.start);f.push({start:e.toISOString(),end:s.toISOString(),available:!t}),g=new Date(g.getTime()+6e4*r)}let j=new Date,v=j.getFullYear()===c&&j.getMonth()===d-1&&j.getDate()===m;return f.filter(e=>!v||new Date(e.start)>j)}t.d(s,{x:function(){return n}})},7211:function(e,s,t){"use strict";t.d(s,{B:function(){return a}});var n=t(7294);async function r(e){if(!e||!e.includes("@"))return null;try{let s=await fetch("/api/client?email=".concat(encodeURIComponent(e)));if(!s.ok)return null;return(await s.json()).client||null}catch(e){return console.error("Error al autocompletar datos del cliente:",e),null}}function a(e){let[s,t]=(0,n.useState)(!1);return{isFetchingClient:s,handleEmailBlur:(0,n.useCallback)(async s=>{let n=s.target.value;if(n&&n.includes("@"))try{t(!0);let s=await r(n);s&&e(e=>({...e,name:s.name||e.name,phone:s.phone||e.phone}))}finally{t(!1)}},[e])}}},6473:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var n=t(5893),r=t(7294),a=t(9008),i=t.n(a),l=t(1664),o=t.n(l),c=t(3957),d=t(9257),m=t(221),u=t(5411),x=t(3794),h=t(8583),p=t(429),f=t(7211);let g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:28,s=[],t=new Date;for(let n=0;n<e;n++){let e=(0,c.E)(t,n);s.push(e)}return s};function b(){var e,s;let[t,a]=(0,r.useState)(""),[l,c]=(0,r.useState)(null),[b,j]=(0,r.useState)(""),[v,y]=(0,r.useState)({name:"",email:"",phone:""}),[N,w]=(0,r.useState)(1),[k,S]=(0,r.useState)([]),[C,E]=(0,r.useState)(!1),[M,U]=(0,r.useState)(null),[D,T]=(0,r.useState)(null),[R,W]=(0,r.useState)({width:void 0,height:void 0}),H=g(35),{isFetchingClient:O,handleEmailBlur:P}=(0,f.B)(y);(0,r.useEffect)(()=>{function e(){W({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);let _=(0,r.useCallback)(async(e,s)=>{try{E(!0),U(null);let t=(0,d.WU)(e,"yyyy-MM-dd"),n=u.u.find(e=>String(e.id)===String(s));if(!n)throw Error("Servicio no encontrado");let r=await fetch("/api/slots?action=getBusySlots&date=".concat(t)),a=await r.json().catch(()=>null);if(!r.ok||!a)throw Error((null==a?void 0:a.error)||"Error cargando horarios");let i=(0,x.x)({date:t,openHour:18,closeHour:20,stepMinutes:30,durationMinutes:n.duration,busy:a.busy||[],allowOverflowEnd:!0}).filter(e=>e.available).map(e=>(0,d.WU)(new Date(e.start),"HH:mm"));S(i)}catch(e){U(String((null==e?void 0:e.message)||e)),S([])}finally{E(!1)}},[]);function B(e,s){y(t=>({...t,[e]:s}))}async function A(e){e.preventDefault();try{T({loading:!0});let e=u.u.find(e=>e.id===t),s={serviceId:t,serviceName:null==e?void 0:e.name,durationMin:null==e?void 0:e.duration,date:(0,d.WU)(l,"yyyy-MM-dd"),start:b,extraCupo:!0,client:v},n=await fetch("/api/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),r=await n.json();if(!n.ok||(null==r?void 0:r.error))throw Error((null==r?void 0:r.error)||"Error al confirmar la cita");T({success:!0,message:"\xa1Cita EXTRA CUPO confirmada!"}),setTimeout(()=>{a(""),c(null),j(""),y({name:"",email:"",phone:""}),w(1),T(null)},2500)}catch(e){T({error:!0,message:String(e.message||e)})}}(0,r.useEffect)(()=>{l&&t&&_(l,t)},[l,t,_]);let F=e=>e?(0,d.WU)(e,"d MMMM yyyy",{locale:m.es}):"";return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsxs)(i(),{children:[(0,n.jsx)("title",{children:"Turnos Extra Cupos - Vanessa Nails Studio"}),(0,n.jsx)("meta",{name:"description",content:"Reserva extra cupos (18:00 a 20:00) con recargo"})]}),(0,n.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-pink-600",children:"Turnos Extra Cupos"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Horarios extendidos (18:00 a 20:00) con recargo"})]}),(0,n.jsxs)(o(),{href:"/",className:"inline-flex items-center text-pink-600 hover:text-pink-800",children:[(0,n.jsx)("span",{className:"text-lg",children:"←"}),(0,n.jsx)("span",{className:"ml-2",children:"Volver"})]})]}),(0,n.jsxs)("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 text-amber-900 rounded-lg",children:["⚠ Al seleccionar estos turnos, existe un ",(0,n.jsx)("b",{children:"recargo adicional de $5.000"}),", indistintamente del servicio."]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("div",{className:"flex justify-center items-center mb-4",children:[1,2,3,4].map(e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(N>=e?"bg-pink-600 text-white":"bg-gray-300 text-gray-600"),children:e}),e<4&&(0,n.jsx)("div",{className:"w-16 h-1 ".concat(N>e?"bg-pink-600":"bg-gray-300")})]},e))}),(0,n.jsxs)("div",{className:"flex justify-between max-w-xs mx-auto text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"flex-1 text-center",children:"Servicio"}),(0,n.jsx)("span",{className:"flex-1 text-center",children:"Fecha"}),(0,n.jsx)("span",{className:"flex-1 text-center",children:"Hora"}),(0,n.jsx)("span",{className:"flex-1 text-center",children:"Datos"})]})]}),1===N&&(0,n.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold mb-8 text-center text-gray-800",children:"Selecciona tu servicio"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...u.u].sort((e,s)=>e.duration-s.duration).map(e=>(0,n.jsxs)("div",{onClick:()=>{a(e.id),c(null),j(""),w(2)},className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer border border-gray-100 overflow-hidden transform hover:-translate-y-1 hover:scale-105 h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"p-6 flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center group-hover:bg-pink-200 transition-colors flex-shrink-0",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsxs)("div",{className:"bg-pink-100 text-pink-800 text-xs font-bold px-2 py-1 rounded-full",children:[e.duration," min"]})]}),(0,n.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4 group-hover:text-pink-600 transition-colors flex-1",children:e.name}),(0,n.jsxs)("button",{className:"mt-auto w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 shadow-md hover:shadow-lg flex items-center justify-center",children:["Seleccionar",(0,n.jsx)("svg",{className:"inline-block w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-500/5 to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]},e.id))})]}),2===N&&(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsxs)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:["Selecciona una fecha para ",null===(e=u.u.find(e=>String(e.id)===String(t)))||void 0===e?void 0:e.name]}),(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:H.map((e,s)=>{let t=(0,d.WU)(e,"yyyy-MM-dd"),r=new Date;r.setHours(0,0,0,0);let a=t===(0,d.WU)(r,"yyyy-MM-dd"),i=l?(0,d.WU)(l,"yyyy-MM-dd"):"";return(0,n.jsxs)("button",{onClick:()=>{c(e),j(""),w(3)},className:"p-3 rounded-lg border transition-all focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 ".concat(i===t?"bg-pink-600 text-white border-pink-600 transform scale-105":"bg-white text-gray-800 border-gray-200 hover:border-pink-300 hover:shadow-sm"),children:[(0,n.jsx)("div",{className:"font-medium",children:a?"Hoy":(0,d.WU)(e,"EEE",{locale:m.es})}),(0,n.jsx)("div",{className:"text-lg font-bold",children:(0,d.WU)(e,"d")}),(0,n.jsx)("div",{className:"text-xs",children:(0,d.WU)(e,"MMM",{locale:m.es})})]},s)})}),(0,n.jsx)("div",{className:"mt-6 text-center",children:(0,n.jsx)(o(),{href:"/",className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a inicio"})})]}),3===N&&(0,n.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,n.jsxs)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:["Selecciona un horario para el ",F(l)]}),M&&(0,n.jsxs)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Error:"})," ",String(M)]}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Por favor, verifica tu conexi\xf3n e int\xe9ntalo nuevamente."})]}),l&&(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Horarios disponibles - ",F(l)]}),C?(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Cargando horarios disponibles..."}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"})})]}):k&&k.length>0?(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:k.map(e=>(0,n.jsx)("button",{onClick:()=>{j(e),w(4)},className:"p-3 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50 ".concat(b===e?"bg-pink-600 text-white transform scale-105":"bg-white border border-gray-200 hover:border-pink-300 hover:shadow-sm"),children:e},e))}):(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"No hay horarios disponibles para este d\xeda. Elige otro d\xeda."}),(0,n.jsx)("button",{onClick:()=>w(2),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"← Volver a fechas"})]})]}),(0,n.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,n.jsx)("button",{onClick:()=>w(2),className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a fechas"}),b&&(0,n.jsx)("button",{onClick:()=>w(4),className:"px-6 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50",children:"Continuar"})]})]}),4===N&&((null==D?void 0:D.success)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{width:R.width,height:R.height,recycle:!1,numberOfPieces:500,tweenDuration:1e4}),(0,n.jsx)(p.Z,{service:u.u.find(e=>String(e.id)===String(t)),date:l,time:b,client:v,isExtra:!0})]}):(0,n.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Tus datos"}),(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6 border border-gray-200",children:[(0,n.jsx)("h3",{className:"font-semibold mb-3 text-lg",children:"Resumen de tu cita (EXTRA CUPO):"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"font-medium",children:"Servicio:"}),(0,n.jsx)("span",{children:null===(s=u.u.find(e=>String(e.id)===String(t)))||void 0===s?void 0:s.name})]}),(0,n.jsxs)("p",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"font-medium",children:"Fecha:"}),(0,n.jsx)("span",{children:F(l)})]}),(0,n.jsxs)("p",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"font-medium",children:"Hora:"}),(0,n.jsx)("span",{children:b})]})]})]}),(0,n.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),(0,n.jsx)("input",{type:"text",required:!0,value:v.name,onChange:e=>B("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"Tu nombre completo"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"email",required:!0,value:v.email,onChange:e=>B("email",e.target.value),onBlur:P,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"tu@email.com"}),O&&(0,n.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-pink-600"})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono *"}),(0,n.jsx)("input",{type:"tel",required:!0,value:v.phone,onChange:e=>B("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-colors",placeholder:"+56 9 1234 5678"})]}),D&&(0,n.jsxs)("div",{className:"mt-4 p-4 rounded-lg ".concat(D.loading?"bg-blue-100 text-blue-800":D.success?"bg-green-100 text-green-800":D.error?"bg-red-100 text-red-800":""),children:[D.loading&&(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),(0,n.jsx)("span",{children:"Confirmando cita..."})]}),D.success&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-semibold",children:D.message}),(0,n.jsx)("p",{className:"text-sm mt-1",children:"Revisa tu correo para el detalle e invitaci\xf3n de Calendar."})]}),D.error&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"font-semibold",children:["Error: ",D.message]}),(0,n.jsx)("p",{className:"text-sm mt-1",children:"Por favor, int\xe9ntalo nuevamente."})]})]}),(0,n.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row justify-between gap-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>w(3),className:"px-4 py-2 text-pink-600 hover:text-pink-800 transition-colors",children:"← Volver a horarios"}),(0,n.jsx)("button",{type:"submit",disabled:null==D?void 0:D.loading,className:"px-6 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 disabled:opacity-50 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50",children:(null==D?void 0:D.loading)?"Confirmando...":"Confirmar Cita"})]})]})]}))]}),(0,n.jsx)("footer",{className:"py-6 text-center text-gray-500 text-sm",children:(0,n.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Vanessa Nails Studio. Todos los derechos reservados."]})})]})}}},function(e){e.O(0,[801,888,774,179],function(){return e(e.s=8778)}),_N_E=e.O()}]);